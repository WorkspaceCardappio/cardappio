<form [formGroup]="form">
  <div class="grid mt-3">
    <div class="col-12 flex flex-column mt-3 gap-1">
      <label for="products" class="required-label">Produto</label>
      <p-autoComplete
        id="products"
        formControlName="product"
        [suggestions]="products.values"
        (completeMethod)="searchProducts($event)"
        [dropdown]="true"
        placeholder="Selecione o produto"
        optionLabel="name"
        fluid
        [emptyMessage]="'Nenhum produto encontrado'"
      >
      </p-autoComplete>
    </div>

    <div class="flex col-6 gap-4 mt-4">
      <span class="flex flex-column gap-1" style="width: 70vw">
        <label for="option" class="required-label">Opção</label>

        @if (options.values.length) {
        <p-selectButton
          id="option"
          [options]="options.values"
          formControlName="item"
          optionLabel="label"
          [optionDisabled]="'disabled'"
        >
          <ng-template let-option pTemplate="item">
            <div
              class="p-d-flex p-flex-column p-ai-center p-p-4"
              [ngClass]="{
                available: option.disabled,
                unavailable: !option.disabled
              }"
            >
              <div class="font-bold mb-1">{{ option.size }}</div>
              <div class="text-sm text-gray-600">
                {{ option.description }}
              </div>

              <div class="text-sm font-bold mt-2">
                {{ option.price | currency : "BRL" : "symbol" : "1.2-2" }}
              </div>

              @if (option.disabled) {
              <div class="text-xs font-semibold mt-1 text-red-600">
                Indisponível
              </div>
              }
            </div>
          </ng-template>
        </p-selectButton>
        } @else if(form.get('product')?.value?.id) {
        <div
          class="flex justify-content-center align-items-center border-round-lg border-1 border-gray-300 p-4 text-center text-gray-600 text-sm"
          style="min-height: 5rem; background-color: #f9f9f9; max-width: 30vw;"
        >
          Não foram encontradas opções para o produto selecionado, cadastre as
          opções no produto.
        </div>
        } @else {
        <div
          class="flex justify-content-center align-items-center border-round-lg border-1 border-gray-300 p-4 text-center text-gray-600 text-sm"
          style="min-height: 5rem; background-color: #f9f9f9; max-width: 30vw;"
        >
          Selecione um produto para exibir as opções.
        </div>
        }
      </span>
    </div>

    <div class="col-1 flex flex-column mt-6 gap-1">
      <label for="quantity" class="required-label">Quantidade</label>
      <p-inputNumber
        id="quantity"
        formControlName="quantity"
        [showButtons]="true"
        [buttonLayout]="'horizontal'"
        [step]="1"
        [min]="1"
        [max]="20"
        decrementButtonClass="p-button-secondary"
        incrementButtonClass="p-button-secondary"
        incrementButtonIcon="pi pi-plus"
        decrementButtonIcon="pi pi-minus"
        inputStyleClass="text-center w-4rem"
      />
    </div>

    <div class="col-2 flex flex-column mt-6 gap-1 ml-4">
      <label for="price">Preço</label>
      <p-inputNumber
        inputId="price"
        formControlName="price"
        placeholder="Preço"
        mode="currency"
        currency="BRL"
        locale="pt-BR"
        [disabled]="true"
      ></p-inputNumber>
    </div>

    <div class="col-2 flex flex-column mt-6 gap-1">
      <label for="total">Total</label>
      <p-inputNumber
        inputId="total"
        formControlName="total"
        placeholder="Total"
        mode="currency"
        currency="BRL"
        locale="pt-BR"
        [disabled]="true"
      ></p-inputNumber>
    </div>
  </div>

  <div class="mt-4 flex justify-content-end gap-2">
    <button
      pButton
      type="button"
      label="Anterior"
      severity="danger"
      (click)="prevEmitter.emit()"
    ></button>
    <button
      pButton
      type="button"
      label="Próximo"
      class="p-button-primary"
      (click)="nextEmitter.emit()"
      [disabled]="this.form.invalid"
    ></button>
  </div>
</form>
