<p-breadcrumb [model]="items" [home]="home"></p-breadcrumb>

<p-fieldset legend="Novo Pedido">
  <p-stepper [value]="stepIndex" class="basis-[50rem]" [linear]="true">
    <p-step-list>
      <p-step [value]="1">Informações Gerais</p-step>
      <p-step [value]="2">Opções</p-step>
      <p-step [value]="3">Adicionais</p-step>
      <p-step [value]="4">Variáveis</p-step>
      <p-step [value]="5">Resumo</p-step>
    </p-step-list>
    <p-step-panels>
      <p-step-panel [value]="1">
        <ng-template #content let-activateCallback="activateCallback">
          <form [formGroup]="form" class="p-fluid">
            <div class="grid mt-3">
              <div class="col-2 flex flex-column mb-4 gap-1">
                <label for="number">Número</label>
                <input
                  id="number"
                  pInputText
                  formControlName="number"
                  placeholder="Número"
                  readonly
                  class="input-readonly"
                />
              </div>

              <div class="col-8 flex flex-column gap-1">
                <label for="ticket" class="required-label">Comanda</label>
                <p-autoComplete
                  id="ticket"
                  formControlName="ticket"
                  [suggestions]="tickets.values"
                  (completeMethod)="searchTickets($event)"
                  [dropdown]="true"
                  placeholder="Selecione a comanda"
                  optionLabel="number"
                  fluid
                  [emptyMessage]="'Nenhuma comanda encontrada'"
                >
                </p-autoComplete>
              </div>

              <div class="col-2 flex flex-column mb-4 gap-1">
                <label for="createdAt">Criado em</label>
                <p-datepicker
                  formControlName="createdAt"
                  [showIcon]="true"
                  inputId="createdAt"
                  dateFormat="dd/mm/yy"
                  locale="pt-BR"
                  [readonlyInput]="true"
                  [disabled]="true"
                  style="width: 100%"
                ></p-datepicker>
              </div>

              <div class="flex flex-column mb-4 gap-1 col-12">
                <label for="parent" class="required-label"
                  >Vincular um Status</label
                >
                <p-autocomplete
                  formControlName="status"
                  optionLabel="description"
                  [suggestions]="status.values"
                  [dropdown]="true"
                  fluid
                  (completeMethod)="searchStatus()"
                  [emptyMessage]="'Nenhum status encontrado'"
                />
              </div>

              <!-- <div>
                <div class="flex col-12 gap-4">
                  <span class="flex flex-column gap-1" style="width: 70vw">
                    <label for="option" class="required-label">Opção</label>
                    <p-selectButton
                      id="option"
                      [options]="productTypeOptions"
                      formControlName="item"
                      optionLabel="label"
                      [optionDisabled]="'disabled'"
                    >
                      <ng-template let-option pTemplate="item">
                        <div
                          class="p-d-flex p-flex-column p-ai-center p-p-4"
                          [ngClass]="{
                            available: option.disabled,
                            unavailable: !option.disabled
                          }"
                        >
                          <div class="font-bold mb-1">{{ option.label }}</div>
                          <div class="text-sm text-gray-600">
                            {{ option.description }}
                          </div>

                          <div class="text-sm font-bold mt-2">
                            {{
                              option.price
                                | currency : "BRL" : "symbol" : "1.2-2"
                            }}
                          </div>

                          @if (option.disabled) {
                          <div class="text-xs font-semibold mt-1 text-red-600">
                            Indisponível
                          </div>
                          }
                        </div>
                      </ng-template>
                    </p-selectButton>
                  </span>

                  <span class="flex flex-column gap-1" style="width: 100%">
                    <label for="note">Observações</label>
                    <textarea
                      pTextarea
                      id="note"
                      formControlName="note"
                      rows="6"
                      style="resize: none; outline: 0"
                    ></textarea>
                  </span>
                </div>
              </div>

              <div class="flex flex-column gap-3"></div>

              <div
                [formGroup]="formProductItem"
                class="col-12 mt-3 flex gap-6"
                style="align-items: flex-start"
              >
                <span class="flex flex-column gap-1">
                  <label for="quantity" class="required-label">
                    Quantidade
                  </label>
                  <p-inputNumber
                    id="quantity"
                    formControlName="quantity"
                    [showButtons]="true"
                    [buttonLayout]="'horizontal'"
                    [step]="1"
                    [min]="1"
                    [max]="20"
                    decrementButtonClass="p-button-secondary"
                    incrementButtonClass="p-button-secondary"
                    incrementButtonIcon="pi pi-plus"
                    decrementButtonIcon="pi pi-minus"
                    inputStyleClass="text-center w-4rem"
                  />
                </span>

                <span class="total-price-highlight">
                  {{ priceTotal() | currency : "BRL" : "symbol" : "1.2-2" }}
                </span>
              </div> -->
            </div>
          </form>
          <div class="mt-4 flex justify-content-end gap-2">
            <button
              pButton
              type="button"
              label="Cancelar"
              severity="danger"
              (click)="onCancel()"
            ></button>
            <button
              pButton
              type="button"
              label="Próximo"
              class="p-button-primary"
              (click)="next(activateCallback)"
              [disabled]="this.form.invalid"
            ></button>
          </div>
        </ng-template>
      </p-step-panel>
      <p-step-panel [value]="2">
        <ng-template #content let-activateCallback="activateCallback">
          <app-order-options
            [orderId]="'108f464c-f496-4695-a104-f8dc832ba561'"
            (prevEmitter)="prev(activateCallback)"
            (nextEmitter)="next(activateCallback)"
          ></app-order-options>
        </ng-template>
      </p-step-panel>
      <p-step-panel [value]="3"> </p-step-panel>
      <p-step-panel [value]="4"> </p-step-panel>
      <p-step-panel [value]="5"> </p-step-panel>
    </p-step-panels>
  </p-stepper>
</p-fieldset>
