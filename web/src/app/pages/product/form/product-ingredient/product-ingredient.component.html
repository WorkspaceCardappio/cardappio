<div class="grid w-full mt-4">
  <div class="col-11 flex flex-column mb-4 gap-1">
    <label for="ingredient">Buscar ingrediente</label>
    <p-autoComplete
      [suggestions]="filteredIngredients"
      (completeMethod)="searchIngredients($event)"
      (onSelect)="onSelectionChange($event)"
      optionLabel="name"
      [dropdown]="true"
      placeholder="Digite o nome do ingrediente"
      [disabled]="loading"
      inputId="ingredient"
    ></p-autoComplete>
  </div>

  <div class="col-1 flex align-items-end mb-4">
    <p-button
      label="Adicionar"
      icon="pi pi-plus"
      (click)="addIngredient()"
      [disabled]="!selectedIngredient"
    ></p-button>
  </div>
</div>

<p-table
  [value]="form.getRawValue()"
  showGridlines
  [paginator]="true"
  [rows]="5"
  class="mt-4"
>
  <ng-template pTemplate="header">
    <tr>
      <th pSortableColumn="name">Nome <p-sortIcon field="name" /></th>
      <th>Unidade</th>
      <th style="width: 8rem">Ações</th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-item let-rowIndex="rowIndex">
    <tr>
      <td>{{ item.ingredient?.name }}</td>
      <td>{{ item.ingredient?.unityOfMeasurement.description }}</td>
      <td>
        <button
          pButton
          type="button"
          icon="pi pi-trash"
          class="p-button-text p-button-sm p-button-danger"
          aria-label="Excluir"
          (click)="deleteIngredient(rowIndex)"
        ></button>
      </td>
    </tr>
  </ng-template>

  <ng-template pTemplate="emptymessage">
    <tr>
      <td colspan="4" class="text-center">Nenhum ingrediente adicionado.</td>
    </tr>
  </ng-template>
</p-table>

<div class="mt-4 flex justify-content-end gap-2">
  <button
    pButton
    type="button"
    label="Anterior"
    severity="danger"
    (click)="prev()"
  ></button>
  <button
    pButton
    type="button"
    label="Próximo"
    class="p-button-primary"
    (click)="onSave()"
  ></button>
</div>
