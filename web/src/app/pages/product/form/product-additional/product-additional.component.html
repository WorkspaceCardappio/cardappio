<div class="grid w-full mt-4" [formGroup]="form">
  <div class="col-4 flex flex-column mb-4 gap-1">
    <label for="name" class="required-label">Nome</label>
    <input id="name" pInputText formControlName="name" placeholder="Nome" />
  </div>
  <div class="col-4 flex flex-column mb-4 gap-1">
    <label for="additional">Escolha um adicional</label>
    <p-autocomplete
      formControlName="productAdditional"
      optionLabel="name"
      [suggestions]="filteredProducts"
      (completeMethod)="searchProducts($event)"
      [dropdown]="true"
      fluid
    ></p-autocomplete>
  </div>

  <div class="col-2 flex flex-column mb-4 gap-1">
    <label for="price">Preço</label>
    <p-inputNumber
      inputId="price"
      formControlName="price"
      placeholder="Preço"
      mode="currency"
      currency="BRL"
      locale="pt-BR"
    ></p-inputNumber>
  </div>
  <div class="col-2 flex flex-column mb-4 gap-2">
    <label for="active">Ativo</label>
    <p-toggle-switch
      inputId="active"
      formControlName="active"
    ></p-toggle-switch>
  </div>
</div>

<p-button
  type="button"
  label="Adicionar"
  icon="pi pi-plus"
  (click)="addAdditional()"
  [disabled]="this.form.invalid"
></p-button>

<p-table
  [value]="additionalsToSave"
  [paginator]="true"
  [rows]="5"
  [responsiveLayout]="'scroll'"
  class="mt-4"
>
  <ng-template pTemplate="header">
    <tr>
      <th>Nome</th>
      <th>Produto</th>
      <th>Preço</th>
      <th>Status</th>
      <th style="width: 10rem">Ações</th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-additional let-i="rowIndex">
    <tr>
      <td>{{ additional.productAdditional.name }}</td>
      <td>{{ additional.name }}</td>
      <td>{{ additional.price | currency : "BRL" : "symbol" : "1.2-2" }}</td>
      <td>
        @if (additional.active) {
        <i class="pi pi-check-circle" style="color: #51cf66"></i>
        } @else {
        <i class="pi pi-times-circle" style="color: #d33b19"></i>
        }
      </td>
      <td>
        <button
          pButton
          type="button"
          icon="pi pi-trash"
          class="p-button-text p-button-sm p-button-danger"
          aria-label="Excluir"
          (click)="deleteAdditional(i)"
        ></button>
      </td>
    </tr>
  </ng-template>

  <ng-template pTemplate="emptymessage">
    <tr>
      <td colspan="3" class="text-center">Nenhum adicional cadastrado.</td>
    </tr>
  </ng-template>
</p-table>

<div class="mt-4 flex justify-content-end gap-2">
  <button
    pButton
    type="button"
    label="Cancelar"
    severity="danger"
    (click)="prevEmitter.emit()"
  ></button>
  <button
    pButton
    type="button"
    label="Próximo"
    class="p-button-primary"
    (click)="onSave()"
  ></button>
</div>
