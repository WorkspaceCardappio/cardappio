<form [formGroup]="form">
  <div class="grid w-full gap-4">
    <div class="col-3 flex flex-column gap-1">
      <label>Tamanho</label>
      <p-select
        [options]="itemSize"
        optionLabel="description"
        optionValue="code"
        formControlName="size"
        placeholder="Selecione o tamanho"
      >
      </p-select>
    </div>

    <div class="col-3 flex flex-column gap-1">
      <label>Preço</label>
      <p-inputNumber
        formControlName="price"
        mode="currency"
        currency="BRL"
        locale="pt-BR"
        placeholder="Preço"
      >
      </p-inputNumber>
    </div>

    <div class="col-3 flex flex-column gap-1">
      <label>Quantidade disponível</label>
      <p-inputNumber formControlName="quantity" placeholder="Quantidade">
      </p-inputNumber>
    </div>

    <div class="col-2 flex flex-column gap-1">
      <label>Ativo</label>
      <p-toggle-switch formControlName="active"></p-toggle-switch>
    </div>

    <div class="col-12 flex flex-column gap-1">
      <label>Descrição</label>
      <textarea pTextarea rows="3" formControlName="description"> </textarea>
    </div>
  </div>
</form>
<div class="mt-4">
  <h4>Ingredientes</h4>
  <p-table
    [value]="getProductItemIngredientsFormArray().controls"
    dataKey="id"
    showGridlines
    stripedRows
  >
    <ng-template pTemplate="header">
      <tr>
        <th>Ingrediente</th>
        <th>Quantidade usada</th>
        <th>Unidade de medida</th>
        <th>Ações</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-row let-i="rowIndex">
      <tr [formGroup]="getIngredientFormGroup(i)">
        <td>{{ row.get("ingredient")?.value?.name }}</td>
        <td>
          <p-inputNumber
            formControlName="quantity"
            [min]="0"
            placeholder="Quantidade"
          ></p-inputNumber>
        </td>
        <td>
          {{ row.get("ingredient")?.value?.unityOfMeasurement?.description }}
        </td>
        <td>
          <button
            pButton
            type="button"
            icon="pi pi-pencil"
            class="p-button-text p-button-sm"
            aria-label="Editar"
          ></button>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="4" class="text-center">Nenhum ingrediente adicionado.</td>
      </tr>
    </ng-template>
  </p-table>
</div>
<div class="flex justify-end mt-2">
  <p-button
    label="Adicionar Produto"
    icon="pi pi-plus"
    (onClick)="onAddProductsToSave()"
  >
  </p-button>
</div>

<div>
  <p-table [value]="productsToSave" dataKey="id" showGridlines stripedRows>
    <ng-template pTemplate="header">
      <tr>
        <th>Tamanho</th>
        <th>Preço</th>
        <th>Quantidade disponível</th>
        <th>Ações</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-row let-i="rowIndex">
      <tr>
        <td>{{ row.size }}</td>
        <td>{{ row.price | currency:'BRL':'symbol':'1.2-2'}}</td>
        <td>{{ row.quantity }}</td>
        <td>
          <button
            pButton
            type="button"
            icon="pi pi-pencil"
            class="p-button-text p-button-sm"
            (click)="onEditProduct(i)"
            style="margin-right: 0.5rem"
            aria-label="Editar"
          ></button>
          <button
            pButton
            type="button"
            icon="pi pi-trash"
            class="p-button-text p-button-sm p-button-danger"
            (click)="onDeleteProduct(i)"
            aria-label="Excluir"
          ></button>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="4" class="text-center">Nenhum ingrediente adicionado.</td>
      </tr>
    </ng-template>
  </p-table>
</div>

<div class="mt-4 flex justify-content-end gap-2">
  <button
    pButton
    type="button"
    label="Cancelar"
    severity="danger"
    (click)="prevEmitter.emit()"
  ></button>
  <button
    pButton
    type="button"
    label="Próximo"
    class="p-button-primary"
  ></button>
</div>
