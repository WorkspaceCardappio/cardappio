<p-breadcrumb [model]="items" [home]="home"></p-breadcrumb>

<div class="kanban-container">
  <p-card header="PENDENTE" class="kanban-column" id="pendingList">
    <div
      cdkDropList
      [cdkDropListData]="pending"
      class="kanban-list"
      (cdkDropListDropped)="drop($event)">

      @if (loading) {
        <div class="kanban-card-skeleton">
          <p-skeleton height="2rem" class="mb-2"></p-skeleton>
          <p-skeleton height="1rem" width="70%"></p-skeleton>
        </div>
        <div class="kanban-card-skeleton">
          <p-skeleton height="2rem" class="mb-2"></p-skeleton>
          <p-skeleton height="1rem" width="50%"></p-skeleton>
        </div>
      } @else {
        @for (order of pending; track order.id) {
          <div cdkDrag class="kanban-card">
            <div class="flex justify-content-between align-items-center">
              <span class="text-xl font-bold">#{{ order.number }}</span>
              <p-tag severity="warn" value="Pendente"></p-tag>
            </div>

            <div class="mt-2 text-sm text-600">
              <i class="pi pi-ticket mr-1"></i>
              Comanda: {{ order.ticket?.number || 'N/A' }}
            </div>

            <div class="text-sm text-600">
              <i class="pi pi-clock mr-1"></i>
              Data: {{ order.createdAt | date : "HH:mm" }}
            </div>

            <div class="mt-3 order-items">
              <p class="font-semibold text-sm mb-1">Itens:</p>
              <div class="text-xs text-700">
                - 1x Pizza Marguerita (G)
              </div>
              <div class="text-xs text-700">
                - 2x Refrigerante Cola
              </div>
            </div>
          </div>
        }
      }

      @if (!loading && pending.length === 0) {
        <div class="text-center text-500 mt-3">Nenhum pedido pendente.</div>
      }
    </div>
  </p-card>

  <p-card header="EM ANDAMENTO" class="kanban-column" id="inProgressList">
    <div
      cdkDropList
      [cdkDropListData]="inProgress"
      class="kanban-list"
      (cdkDropListDropped)="drop($event)">

      @if (loading) {
      } @else {
        @for (order of inProgress; track order.id) {
          <div cdkDrag class="kanban-card in-progress">
            <div class="flex justify-content-between align-items-center">
              <span class="text-xl font-bold">#{{ order.number }}</span>
              <p-tag severity="info" value="Em Andamento"></p-tag>
            </div>

            <div class="mt-2 text-sm text-600">
              <i class="pi pi-ticket mr-1"></i>
              Comanda: {{ order.ticket?.number || 'N/A' }}
            </div>

            <div class="text-sm text-600">
              <i class="pi pi-clock mr-1"></i>
              Início: {{ order.createdAt | date : "HH:mm" }}
            </div>

            <div class="mt-3 order-items">
              <p class="font-semibold text-sm mb-1">Itens:</p>
              <div class="text-xs text-700">
                - 1x Prato Executivo B
              </div>
            </div>
          </div>
        }
      }

      @if (!loading && inProgress.length === 0) {
        <div class="text-center text-500 mt-3">Nenhum pedido em produção.</div>
      }
    </div>
  </p-card>

  <p-card header="PRONTO" class="kanban-column" id="readyList">
    <div
      cdkDropList
      [cdkDropListData]="ready"
      class="kanban-list"
      (cdkDropListDropped)="drop($event)">

      @if (loading) {
      } @else {
        @for (order of ready; track order.id) {
          <div cdkDrag class="kanban-card ready">
            <div class="flex justify-content-between align-items-center">
              <span class="text-xl font-bold">#{{ order.number }}</span>
              <p-tag [style]="{ background: '#22c55e' }" value="Pronto"></p-tag>
            </div>

            <div class="mt-2 text-sm text-600">
              <i class="pi pi-ticket mr-1"></i>
              Comanda: {{ order.ticket?.number || 'N/A' }}
            </div>

            <div class="text-sm text-600">
              <i class="pi pi-check-circle mr-1 text-green-500"></i>
              Finalizado: {{ order.createdAt | date : "HH:mm" }}
            </div>

            <div class="mt-3 order-items">
              <p class="font-semibold text-sm mb-1">Itens:</p>
              <div class="text-xs text-700">
                - 3x Pão de Alho
              </div>
            </div>
          </div>
        }
      }

      @if (!loading && ready.length === 0) {
        <div class="text-center text-500 mt-3">Nenhum pedido pronto.</div>
      }
    </div>
  </p-card>
</div>
